<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Job Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3"></script>

<script>
window.supabaseClient = supabase.createClient(
  "https://cyaxvuwkwptaxbkpwyid.supabase.co",
  "sb_publishable_wshxDs-Q_gUgYXxVjw7bwA_ycY3kndA"
);
</script>

<style>
body{font-family:Arial;background:#eef2f6;margin:0}
header{background:#0b5ed7;color:white;padding:10px;text-align:center}
.card{background:white;margin:12px;padding:15px;border-radius:12px}
input,textarea{width:100%;padding:8px;margin-top:6px}
button{width:100%;padding:12px;background:#198754;color:white;border:none}
</style>
</head>

<body>

<header>
<h3>Job Card Request</h3>
</header>

<div class="card">

<input id="job_no" placeholder="Job No">
<input id="issued_to" placeholder="Issued To">
<input type="date" id="job_date">
<input id="train_no" placeholder="Train No">
<input id="job_type" placeholder="Job Type">
<textarea id="failure_desc" placeholder="Failure"></textarea>
<textarea id="work_details" placeholder="Work Details"></textarea>
<input id="sic_required" placeholder="SIC Required">

<button onclick="saveJob()">Save Job Card</button>

</div>

<script>
async function saveJob(){

const payload={
 job_no:job_no.value,
 issued_to:issued_to.value,
 job_date:job_date.value,
 train_no:train_no.value,
 job_type:job_type.value,
 failure_desc:failure_desc.value,
 work_details:work_details.value,
 sic_required:sic_required.value
}

const {error}=await window.supabaseClient
.from("job_cards")
.insert([payload])

if(error){
 alert(error.message)
}else{
 alert("Job Card Saved")
 document.querySelectorAll("input,textarea").forEach(e=>e.value="")
}

}
</script>

</body>
</html>
